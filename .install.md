# Install
This document outline what I need to do when I setup a new OSX
system.

### Set US-int keyboard layout


### nix and nix-darwin
``` sh
sudo diskutil apfs addVolume disk1 APFS 'Nix Store' -mountpoint /nix
sh <(curl -L https://nixos.org/nix/install) --darwin-use-unencrypted-nix-store-volume
source $HOME/.nix-profile/etc/profile.d/nix.sh
nix-build https://github.com/LnL7/nix-darwin/archive/master.tar.gz -A installer ./result/bin/darwin-installer
rm -r result
```


### OSX Command line developer tools
```sh
xcode-select --install
```


### homebrew
```sh
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
brew doctor
```

### brew-cask
```sh
brew install caskroom/cask/brew-cask
brew cask doctor
```

### Chrome
```sh
brew cask install google-chrome
brew install openssh coreutils
```

### generate ssh keys
Copy ~/.ssh/is_rsa.pub to GitHub.

### dotfiles
```sh
cd ~; git init
git remote add origin git@github.com:neic/dotfiles.git
git pull origin master
echo "[user]\n  email = neic@neic.dk\n[github]\n  user = neic@neic.dk" > .gitconfig
```

### nix

``` sh
darwin-rebuild switch
```

### zsh

- Use 'pro' profile with
 - Fontsize 12
 - Close the tab when shell exits cleanly

### Emacs and Spacemacs
```sh
brew tap railwaycat/emacsmacport
brew cask install emacs-mac
brew install emacs-mac
git clone -b develop https://github.com/syl20bnr/spacemacs ~/.emacs.d
```

### MacTeX
```sh
curl -OL http://mirror.ctan.org/systems/mac/mactex/MacTeX.pkg
```

### Python
``` sh
brew install pyenv pipenv zlib sqlite
export LDFLAGS="${LDFLAGS} -L/usr/local/opt/zlib/lib -L/usr/local/opt/sqlite/lib"
export CPPFLAGS="${CPPFLAGS} -I/usr/local/opt/zlib/include -I/usr/local/opt/sqlite/include"
export PKG_CONFIG_PATH="${PKG_CONFIG_PATH} /usr/local/opt/zlib/lib/pkgconfig /usr/local/opt/sqlite/lib/pkgconfig"
export PYTHON_CONFIGURE_OPTS="--enable-framework"
pyenv install 3.7.6
pyenv install 3.8.1
pyenv global 3.8.1
```
Documentation:
- [My python development environment, 2018 edition](https://jacobian.org/writing/python-environment-2018/)

### yabai

``` sh
brew tap koekeishiya/formulae
brew install yabai
brew services start koekeishiya/formulae/yabai
```

### Other software
```sh
brew cask install flux virtualbox virtualbox-extension-pack vlc firefox gpg-suite thunderbird duet wireshark java docker
brew install atomicparsley colordiff dmg2img ffmpeg gcc gzip htop httpie imagemagick kubernetes-cli languagetool markdown ncdu nmap node pass pv pwgen rsync ssh-copy-id the_silver_searcher trash tree unrar unzip wget youtube-dl zstd
```

### sudoers

For passwordless `enableproxy` and `disableproxy`.

``` sh
EDITOR=nano sudo visudo

neic ALL=(root) NOPASSWD: /usr/sbin/networksetup
```

### Disable OS update
Disable unwanted OS updates:

``` sh
sudo softwareupdate --ignore "macOS Catalina"
defaults write com.apple.systempreferences AttentionPrefBundleIDs 0
killall Dock
```

Reenable with:
``` sh
sudo softwareupdate --reset-ignored
```


### Other stuff

- set up dock
- rename machine name
- set display scale
- setup ssh alias
- copy ssh key to machines
- install Adobe CS


### Fonts
```sh
brew tap caskroom/fonts
brew cask install font-tex-gyre-pagella font-dejavu-sans font-source-code-pro
```

### Kill agents and daemons
Check the following folders for unwanted agents and deamons
``` sh
/Library/StartupItems/
/Library/LaunchDaemons/
/Library/LaunchAgents/
~/Library/LaunchAgents/
```

Check System Preferences -> Extensions for unwanted stuff

<!---
Local Variables:
mode: gfm
End:
-->
